---
title: "가변인자(variadic arguments)"
linkTitle: "가변인자"
weight: 1
type: docs
date: 2020-11-06
description: >-

---

**[정의]**

인수의 개수와 타입이 미리 정해져 있지 않다는 뜻.

변수의 개수가 그때그때 변할 수 있는 인자.

**[주의사항]**

가변인수 함수는 반드시 하나 이상의 고정인수 필요. → ap를 초기화 하기 위해서 마지막 고정인수의 번지를 알아야 하기 때문

함수 내부에서 자신에게 전달된 가변 인수의 개수를 알 수 있도록 해야함. → 전달 될 수 있는 인수 의 개수는 제한 없음. 컴파일러는 인수 개수를 점검하지 않음. 그래서 개수를 알려주지 않으면 함수 내부에서 인수의 개수를 알 방법이 없음. 호출측이 정보를 제공해야함.

함수 내부에서 각각의 가변인수 타입을 알 수 있어야 함. → va_arg의 사용을 위함.

**[기본구조]**

```c
#include <stdarg.h>

void varFunc( int fix, ... )
{
    va_list ap; /* 현재 읽고 있는 번지를 기억하기 위한 변수 */
    va_start( ap, fix ); /* 가변인수를 읽기 위한 준비 */
    while( /* 모든 인수를 읽을 때 까지 */ )
    {
        va_arg( ap, /* 인수타입 */ ) ; /* 가변인수 읽기 */
    }
    va_end(ap); /* 뒷정리 */
}
```

**va_list ap;**
	
	함수로 전달되는 인수들은 스택(stack)에 저장되며 함수는 스택에서 인수를 꺼내씀. 스택에 있는 인수를 읽을 때 포인터 연산을 해야하는데 현재 읽고 있는 번지를 기억하기 위해 va_list형 포인터 변수를 사용.
	va_list타입은 char *형으로 정의되어있음. 스택의 인수를 가리키는 포인터 타입.

**va_start(ap, 마지막 고정인수)**

	ap 포인터 변수가 첫 번째 가변인수를 가리키도록 초기화하는 함수.
	두번째 인자는 가변인수의 시작 변수를 찾기 위한 역할. (그 다음 번지가 가변인수의 시작번지)
	→ va_start 내부에서 ap가 마지막 고정 인수 다음 번지를 가리키도록 함.

**va_arg(ap, 인수타입)**

	가변인수를 읽는 함수.
	ap가 가리키는 번지의 데이터를 가변인수로 읽음.
	두번 째 인수는 가변인수의 데이터형을 나타냄. (❗char, float는 사용 불가능)
	ex) ap위치에 있는 정수값을 읽고 싶을 때 : va_arg(ap, int)
		ap위치에 있는 실수 값을 읽고 싶을 떄 : va_arg(ap, double)

**va_end(ap)**

	가변인수를 읽은 후 함수가 정상적으로 리턴되도록 도와줌.
	va_end가 호출되면 ap가 변경되므로 va_start를 호출하지 않고는 가변인수를 다시 읽을 수 없도록 함.

**[참고]**

[https://aossuper8.tistory.com/17](https://aossuper8.tistory.com/17)

[https://blankspace-dev.tistory.com/235](https://blankspace-dev.tistory.com/235)
